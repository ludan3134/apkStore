{"level":"debug","time":"2024-10-30T05:51:02.044Z","msg":"logger init ok"}
{"level":"debug","time":"2024-10-30T05:51:02.124Z","msg":"try to connect redis"}
{"level":"info","time":"2024-10-30T05:51:02.124Z","name":"Cache.NewCache","msg":"connect to redis","addr":"47.120.68.50:6059"}
{"level":"info","time":"2024-10-30T05:51:02.278Z","name":"ConnectRedis","msg":"connect redis success"}
{"level":"info","time":"2024-10-30T05:51:02.303Z","name":"Cache.NewCache","msg":"connect to redis success"}
{"level":"debug","time":"2024-10-30T05:51:02.304Z","msg":"connect to redis success"}
{"level":"debug","time":"2024-10-30T05:51:02.304Z","msg":"-----------------service success-------------------------"}
{"level":"debug","time":"2024-10-30T05:51:02.304Z","name":"rpc Serve","msg":"try to serve"}
{"level":"info","time":"2024-10-30T05:51:02.342Z","msg":"Connect","pid":2997959,"host":"47.120.68.50","port":6008,"database":"rdb","time":202397079}
{"level":"info","time":"2024-10-30T05:51:02.366Z","msg":"Prepare","name":"SqlFindAppsVersion","sql":"\n\t\t\tUPDATE wst.app_version \n\t\t\tSET is_latest = TRUE \n\t\t\tWHERE\n\t\t\tdate_released = ( SELECT MAX(date_released) FROM wst.app_version WHERE app_id = $1 AND is_latest = FALSE) \n\t\t\tAND app_id = $1;\n\t\t","time":24171130,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.403Z","msg":"Prepare","name":"SqlCountPricePlanList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.price_plans \n\t\t\twhere deleted = false;\n\t\t","time":36967712,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.420Z","msg":"Prepare","time":17043346,"alreadyPrepared":false,"pid":2997959,"name":"SqlUpdatePricePlan","sql":"\n\t\t\tupdate wst.price_plans \n\t\t\tset plan_name = $1, \n\t\t\t    plan_description = $2, \n\t\t\t    billing_cycle = $3, \n\t\t\t    trial_period = $4, \n\t\t\t    price = $5, \n\t\t\t    distributor_id = $6, \n\t\t\t    model_id = $7, \n\t\t\t    deleted = $8 \n\t\t\twhere id = $9;\n\t\t"}
{"level":"info","time":"2024-10-30T05:51:02.438Z","msg":"Prepare","pid":2997959,"name":"SqlUpdateSelf","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND V.\"class\" = $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t","time":17418616,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:51:02.474Z","msg":"Prepare","pid":2997959,"name":"SqlCheckAppPrice","sql":"\n\t\t\t\t\t\tSELECT plan_name\n\t\t\t\t FROM wst.price_plans\n  \t\t\t\t WHERE id = ANY($1::int[])\n\t\t\t\t AND distributor_id = $2\n\t\t\t\t AND model_id = $3\n\t\t","time":25301067,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:51:02.488Z","msg":"Prepare","name":"SqlDeleteApps","sql":"\n\t\t\t\t\t\tDelete \n\t\t\t\t FROM wst.apps\n  \t\t\t\t WHERE id = $1\n\t\t","time":14766404,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.528Z","msg":"Prepare","name":"SqlCountAppsVersionList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.app_version \n\t\t\twhere deleted = false;\n\t\t","time":39758175,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.547Z","msg":"Prepare","name":"SqlCountAppsList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.apps f\n\t\t\twhere CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.app_name ILIKE '%' ||$3 || '%' END\n    \t\tAND (CASE WHEN $4 = 0 THEN TRUE ELSE $4::BIGINT = ANY(f.category_ids) END)\n\t\t\tAND f.deleted = FALSE\n\t\t","time":18388675,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.577Z","msg":"Prepare","alreadyPrepared":false,"pid":2997959,"name":"SqlGetAppDownloadUrl","sql":"\n\t\t\tSELECT url \n\t\t\tFROM wst.app_version \n\t\t\tWHERE app_id = $1 AND is_latest = TRUE AND deleted = false;\n\t\t","time":29986808}
{"level":"info","time":"2024-10-30T05:51:02.640Z","msg":"Prepare","sql":"\n\t\t\tupdate wst.apps \n\t\t\tset app_name = $1,\n\t\t\t    app_description = $2,\n\t\t\t    app_icon = $3,\n\t\t\t    app_carousel = $4,\n\t\t\t    app_sort = $5,\n\t\t\t    app_banner = $6,\n\t\t\t    system_requirement = $7,\n\t\t\t    rating = $8,\n\t\t\t    class = $9,\n\t\t\t    copyright_notice = $10,\n\t\t\t    category_ids = $11,\n\t\t\t    price_plan_ids = $12,\n\t\t\t    is_show_on_market = $13,\n\t\t\t    is_show_tool_tip = $14,\n\t\t\t    distributor_id = $15,\n\t\t\t    model_id = $16,\n\t\t\t    deleted = $17,\n\t\t\t    catpromo =$18,\n\t\t\t    category_id = $19\n\t\t\tWHERE id = $20;\n\t\t","time":21540922,"alreadyPrepared":false,"pid":2997959,"name":"SqlUpdateApps"}
{"level":"info","time":"2024-10-30T05:51:02.659Z","msg":"Prepare","name":"SqlCheckAppUniqueByUpdate","sql":"\n\t\t\tselect id\n\t\t\tfrom wst.apps\n\t\t\twhere class = $1\n\t\t\t  AND distributor_id = $2\n\t\t\t  AND model_id = $3\n\t\t\t  AND deleted = false\n\t\t\t;\n\t\t","time":19057369,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.685Z","msg":"Prepare","pid":2997959,"name":"SqlDeleteAppUser","sql":"\n\t\t\tDELETE FROM wst.app_user WHERE mac = $1;\n\t\t","time":25286346,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:51:02.700Z","msg":"Prepare","name":"SqlInsertPricePlan","sql":"\n\t\t\tinsert into wst.price_plans (\n\t\t\t\tplan_name, \n\t\t\t\tplan_description, \n\t\t\t\tbilling_cycle, \n\t\t\t\ttrial_period, \n\t\t\t\tprice, \n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7\n\t\t\t);\n\t\t","time":15357978,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.716Z","msg":"Prepare","time":16332627,"alreadyPrepared":false,"pid":2997959,"name":"SqlQueryPricePlanList","sql":"\n\t\t\tselect \n\t\t\t\tf.id, \n\t\t\t\tf.plan_name, \n\t\t\t\tf.plan_description, \n\t\t\t\tf.billing_cycle, \n\t\t\t\tf.trial_period, \n\t\t\t\tf.price, \n\t\t\t\tf.distributor_id, \n\t\t\t\tf.model_id, \n\t\t\t\td.title as distributorName, \n\t\t\t\tm.name as modelName \n\t\t\tfrom \n\t\t\t\twst.price_plans f \n\t\t\t\tjoin wst.distributor d on f.distributor_id = d.id \n\t\t\t\tjoin wst.model m on f.model_id = m.id \n\t\t\twhere \n\t\t\t\tf.deleted = false \n\t\t\tlimit $1 offset $2;\n\t\t"}
{"level":"info","time":"2024-10-30T05:51:02.745Z","msg":"Prepare","name":"SqlInsertAppByCopy","sql":"\n\t\t\tinsert into wst.apps (\n\t\t\t\tapp_name,\n\t\t\t\tapp_description,\n\t\t\t\tapp_icon,\n\t\t\t\tapp_carousel,\n\t\t\t\tapp_sort,\n\t\t\t\tapp_banner,\n\t\t\t\tsystem_requirement,\n\t\t\t\trating,\n\t\t\t\tcopyright_notice,\n\t\t\t\tdistributor_id,\n\t\t\t\tmodel_id,\n\t\t\t\tdeleted,\n\t\t\t\tprice_plan_ids,\n\t\t\t\tclass,\n\t\t\t\tcategory_ids,\n\t\t\t\tis_show_on_market,\n\t\t\t\tis_show_tool_tip,\n\t\t\t    catpromo\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13,$14, $15,$16, $17, $18\n\t\t\t) RETURNING  id;\n\t\t","time":16448437,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.760Z","msg":"Prepare","sql":"\n\t\t\tselect count(id)\n\t\t\tfrom wst.apps\n\t\t\twhere class = $1\n\t\t\t  AND distributor_id = $2\n\t\t\t  AND model_id = $3\n\t\t\t  AND deleted = false\n\t\t\t;\n\t\t","time":15343833,"alreadyPrepared":false,"pid":2997959,"name":"SqlCheckAppUniqueByAdd"}
{"level":"info","time":"2024-10-30T05:51:02.778Z","msg":"Prepare","alreadyPrepared":false,"pid":2997959,"name":"SqlQueryAppUserList","sql":"\n\t\t\tSELECT\n\t\t\t\tf.user_name,\n\t\t\t\tf.PASSWORD,\n\t\t\t\tf.mac,\n\t\t\t\tf.ip,\n\t\t\t\tf.country,\n\t\t\t\tf.city,\n\t\t\t\tf.last_login,\n\t\t\t\tf.OPERATOR,\n\t\t\t\tf.distributor_id,\n\t\t\t\tf.model_id,\n\t\t\t\td.title :: TEXT AS distributorName,\n\t\t\t\tM.NAME :: TEXT AS modelName,\n\t\t\t\tf.is_active,\n\t\t\t    f.is_service,\n\t\t\t    f.is_expired\n\t\t\tFROM\n\t\t\t\twst.app_user f\n\t\t\t\tJOIN wst.distributor d ON f.distributor_id = d.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID \n\t\t\twhere \n\t\t\t    CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.mac ILIKE '%' ||$3 || '%' END\n\t\t\t\tAND f.deleted = FALSE\n\t\t\tLIMIT $4 OFFSET $5;\n\t\t","time":17743527}
{"level":"info","time":"2024-10-30T05:51:02.794Z","msg":"Prepare","sql":"\n\t\t\tupdate wst.app_version \n\t\t\tset version_name = $1,\n\t\t\tchangelog = $2,\n\t\t\tis_latest = $3,\n\t\t\tis_paid = $4,\n\t\t\tfilesize = $5,\n\t\t\tmd5 = $6,\n\t\t\turl = $7,\n\t\t\tforce_uninstall = $8,\n\t\t\tdeleted = $9,\n\t\t\tis_public = $10\n\t\t\twhere id = $11;\n\t\t","time":15539824,"alreadyPrepared":false,"pid":2997959,"name":"SqlUpdateAppsVersion"}
{"level":"info","time":"2024-10-30T05:51:02.811Z","msg":"Prepare","alreadyPrepared":false,"pid":2997959,"name":"SqlQueryAppsVersionList","sql":"\n\t\t\tselect f.id,\n\t\t\t       f.app_id,\n\t\t\t       f.version_name,\n\t\t\t       f.date_released,\n\t\t\t       f.changelog,\n\t\t\t       f.is_latest,\n\t\t\t       f.is_public,\n\t\t\t       f.is_paid,\n\t\t\t       f.filesize,\n\t\t\t       f.md5,\n\t\t\t       f.url,\n\t\t\t       f.force_uninstall,\n\t\t\t       f.filesize \n\t\t\tfrom wst.app_version f \n\t\t\twhere f.deleted = false \n\t\t\tand f.app_id = $1::int  \n\t\t\tlimit $2 offset $3;\n\t\t","time":17358879}
{"level":"info","time":"2024-10-30T05:51:02.827Z","msg":"Prepare","alreadyPrepared":false,"pid":2997959,"name":"SqlQueryApps","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON  c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.app_name ILIKE $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t\tORDER BY \n\t\t\t    CAST(app_sort AS INTEGER) ASC;\n\t\t","time":15112082}
{"level":"info","time":"2024-10-30T05:51:02.842Z","msg":"Prepare","pid":2997959,"name":"SqlQueryAppsNewestVersion","sql":"\n\t\t\tSELECT DISTINCT ON (f.ID)\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids) \n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND V.\"class\" = $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t","time":15738258,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:51:02.858Z","msg":"Prepare","name":"GetAppsForPushDesktop","sql":"\n\t\t\tSELECT  DISTINCT ON (f.category_id)\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo,\n\t\t\t\tf.category_id AS categories_id\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND f.distributor_id = $1::bigint\n\t\t\t\tAND f.model_id = $2::bigint\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.is_show_tool_tip = 1\n\t\t\tORDER BY\n    \t\t\tf.category_id ASC -- 分类 ID 排序\n\t\t","time":15027742,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.888Z","msg":"Prepare","alreadyPrepared":false,"pid":2997959,"name":"SqlDeleteAppsVersion","sql":"\n\t\t\t\t\t\tDelete \n\t\t\t\t FROM wst.app_version\n  \t\t\t\t WHERE app_id = $1\n\t\t","time":30447447}
{"level":"info","time":"2024-10-30T05:51:02.904Z","msg":"Prepare","name":"SqlFindDistributorModelByMacInAccount","sql":"\n\t\t\t(SELECT distributor_id, model_id FROM rja.account WHERE mac_string = $1 AND is_active = true )\n\t\t\tUNION ALL\n\t\t\t(SELECT distributor_id, model_id FROM tv_rja.account WHERE mac_string = $1 AND is_active = true);\n\t\t","time":15450982,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.918Z","msg":"Prepare","name":"SqlUpdateAppsVersionIsLatest","sql":"\n\t\t\tUPDATE wst.app_version \n\t\t\tSET is_latest = false \n\t\t\tWHERE app_id = $1;\n\t\t","time":14101197,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.935Z","msg":"Prepare","sql":"\n\t\t\tSELECT \n\t\t\t\tC.ID AS category_ids,\n\t\t\t\tCONCAT(C.category_name, ' - ', d.title, ' - ', M.NAME) AS label \n\t\t\tFROM \n\t\t\t\twst.categories C \n\t\t\t\tLEFT JOIN wst.distributor d ON C.distributor_id = d.ID \n\t\t\t\tLEFT JOIN wst.model M ON C.model_id = M.ID\n\t\t\t\tWhere c.deleted = false\n\t\t\t;\n\t\t","time":17384410,"alreadyPrepared":false,"pid":2997959,"name":"SqlQueryAllCategories"}
{"level":"info","time":"2024-10-30T05:51:02.958Z","msg":"Prepare","name":"SqlFindDistributorModelByMacInTerminal","sql":"\n\t\t\t(SELECT is_used FROM rja.terminal WHERE mac_string = $1 )\n\t\t\tUNION ALL\n\t\t\t(SELECT is_used FROM tv_rja.terminal WHERE mac_string = $1);\n\t\t","time":22785976,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:02.973Z","msg":"Prepare","sql":"\n\t\t\tinsert into wst.app_version (\n\t\t\t\tapp_id,\n\t\t\t\tversion_name,\n\t\t\t\tdate_released,\n\t\t\t\tchangelog,\n\t\t\t\tis_latest,\n\t\t\t\tis_public,\n\t\t\t\tis_paid,\n\t\t\t\tfilesize,\n\t\t\t\tmd5,\n\t\t\t\turl,\n\t\t\t\tforce_uninstall,\n\t\t\t\tdeleted,\n\t\t\t\tclass\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13\n\t\t\t);\n\t\t","time":15090697,"alreadyPrepared":false,"pid":2997959,"name":"SqlInsertAppsVersion"}
{"level":"info","time":"2024-10-30T05:51:02.988Z","msg":"Prepare","alreadyPrepared":false,"pid":2997959,"name":"SqlInsertCategories","sql":"insert into wst.categories (category_name,distributor_id,model_id,sort) values ($1,$2,$3,$4);","time":14292855}
{"level":"info","time":"2024-10-30T05:51:03.002Z","msg":"Prepare","name":"SqlUpdateCategories","sql":"update wst.categories set category_name = $1,deleted = $2,distributor_id = $3,model_id = $4,sort = $5 where id = $6;","time":14568629,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.017Z","msg":"Prepare","name":"SqlQueryCategoriesList","sql":"\n\t\t\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\t\tf.id,\n\t\t\t\t\t\t\t\t\tf.category_name,\n\t\t\t\t\t\t\t\t\tf.distributor_id,\n\t\t\t\t\t\t\t\t\tf.model_id,\n\t\t\t\t\t\t\t\t\td.title ::text AS distributorName,\n\t\t\t\t\t\t\t\t\tM.NAME ::text AS modelName,\n\t\t\t\t\t\t\t\t\tf.sort\n\t\t\t\t\t\t\t\tFROM\n\t\t\t\t\t\t\t\t\twst.categories f\n\t\t\t\t\t\t\t\t\tJOIN wst.distributor d ON f.distributor_id  = d.id\n\t\t\t\t\t\t\t\t\tJOIN wst.model M ON f.model_id = M.ID \n\t\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\t\t\t\tAND f.deleted = FALSE\n\t\t\t\t\t\t\t\tLIMIT $3 OFFSET $4;","time":14583129,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.053Z","msg":"Prepare","name":"SqlInsertApps","sql":"\n\t\t\tinsert into wst.apps (\n\t\t\t\tapp_name,\n\t\t\t\tapp_description,\n\t\t\t\tapp_icon,\n\t\t\t\tapp_carousel,\n\t\t\t\tapp_sort,\n\t\t\t\tapp_banner,\n\t\t\t\tsystem_requirement,\n\t\t\t\trating,\n\t\t\t\tcopyright_notice,\n\t\t\t\tdistributor_id,\n\t\t\t\tmodel_id,\n\t\t\t\tdeleted,\n\t\t\t\tprice_plan_ids,\n\t\t\t\tclass,\n\t\t\t\tcategory_ids,\n\t\t\t\tis_show_on_market,\n\t\t\t\tis_show_tool_tip,\n\t\t\t    catpromo,\n\t\t\t    category_id               \n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13,$14, $15,$16, $17, $18,$19\n\t\t\t);\n\t\t","time":14544939,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.077Z","msg":"Prepare","name":"SqlCheckAppCategories","sql":"\n\t\t\t\tSELECT category_name\n\t\t\t\t FROM wst.categories\n  \t\t\t\t WHERE id = ANY($1)\n\t\t\t\t AND distributor_id = $2\n\t\t\t\t AND model_id = $3\n\t\t","time":24506660,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.097Z","msg":"Prepare","name":"SqlInsertAppUser","sql":"\n\t\t\tINSERT INTO wst.app_user (\n\t\t\t\tuser_name, \n\t\t\t\tPASSWORD, \n\t\t\t\tmac, \n\t\t\t\tip, \n\t\t\t\tcountry, \n\t\t\t\tcity, \n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id, \n\t\t\t\tlast_login, \n\t\t\t\toperator, \n\t\t\t\tdeleted,\n\t\t\t\tis_active,\n\t\t\t  \tis_expired,\n\t\t\t    is_service                      \n\t\t\t) VALUES (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12,$13,$14\n\t\t\t) ON CONFLICT (mac) DO NOTHING\n\t\t\tRETURNING user_name, PASSWORD, mac, ip, country, city, distributor_id, model_id, last_login, operator;\n\t\t","time":18798639,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.117Z","msg":"Prepare","name":"SqlQueryAllPricePlan","sql":"\n\t\t\tSELECT \n\t\t\t\tC.ID AS id, \n\t\t\t\tCONCAT(C.plan_name, ' - ', d.title, ' - ', M.NAME) AS label \n\t\t\tFROM \n\t\t\t\twst.price_plans C \n\t\t\t\tLEFT JOIN wst.distributor d ON C.distributor_id = d.ID \n\t\t\t\tLEFT JOIN wst.model M ON C.model_id = M.ID;\n\t\t","time":20160732,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.139Z","msg":"Prepare","name":"SqlGetAppsByCategories","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo,\n\t\t\t\tf.category_id AS categories_id\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND $1 = ANY(f.category_ids)\n\t\t\t  \tAND c.id =  $1\n\t\t\t\tAND f.distributor_id = $2::bigint\n\t\t\t\tAND f.model_id = $3::bigint\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.is_show_on_market = 1\n\t\t\tORDER BY\n\t\t\t\t  CAST(app_sort AS INTEGER) ASC;\n\t\t","time":22069475,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.160Z","msg":"Prepare","name":"SqlQueryAppUserByMac","sql":"SELECT user_name,password,mac,ip,country,city,distributor_id,model_id,last_login,is_active,is_service,is_expired FROM wst.app_user WHERE mac = $1 AND deleted = false;","time":20667322,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.174Z","msg":"Prepare","alreadyPrepared":false,"pid":2997959,"name":"SqlQueryAppVersionIsLatestByAppId","sql":"\n\t\t\t\t\t\tSelect \n\t\t\t\t\t\t version_name,\n\t\t\t\t\t\t changelog,\n\t\t\t\t\t\t is_latest,\n\t\t\t\t\t\t is_public,\n\t\t\t\t\t\t is_paid,\n\t\t\t\t\t\t filesize,\n\t\t\t\t\t\t md5,\n\t\t\t\t\t\t url,\n\t\t\t\t\t\t force_uninstall,\n\t\t\t\t\t\t class\n\t\t\t\t FROM wst.app_version\n  \t\t\t\t WHERE app_id = $1\n\t\t\t\t AND deleted = false\n\t\t\t     AND is_latest = true;\n\t\t","time":14577677}
{"level":"info","time":"2024-10-30T05:51:03.203Z","msg":"Prepare","name":"SqlUpdateAppUser","sql":"\n\t\t\tupdate wst.app_user \n\t\t\tset user_name = $1, \n\t\t\t    password = $2, \n\t\t\t    ip = $3, \n\t\t\t    country = $4, \n\t\t\t    city = $5, \n\t\t\t    distributor_id = $6, \n\t\t\t    model_id = $7, \n\t\t\t    deleted = $8,\n\t\t\t    is_active = $9,\n\t\t\t    is_service = $10,\n\t\t\t    is_expired = $11\n\t\t\tWHERE mac = $12;\n\t\t","time":14497221,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.217Z","msg":"Prepare","name":"SqlCountAppUserList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.app_user f\n\t\t\twhere CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.mac ILIKE '%' ||$3 || '%' END\n\t\t\tAND f.deleted = FALSE\n\t\t","time":14528471,"alreadyPrepared":false,"pid":2997959}
{"level":"info","time":"2024-10-30T05:51:03.232Z","msg":"Prepare","time":14406989,"alreadyPrepared":false,"pid":2997959,"name":"SqlGetAppsCategories","sql":"\n\t\t\tSELECT id,category_name \n\t\t\tFROM wst.categories \n\t\t\tWHERE distributor_id = $1\n\t\t\tAND model_id = $2\n\t\t\tAND deleted = FALSE \n\t\t\tORDER BY sort ;\n\t\t"}
{"level":"info","time":"2024-10-30T05:51:03.254Z","msg":"Prepare","pid":2997959,"name":"SqlInsertFailureRecord","sql":"\n\t\t\tINSERT INTO wst.failure_log (\n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id, \n\t\t\t\tmac, \n\t\t\t\tdeleted\n\t\t\t) VALUES (\n\t\t\t\t$1,$2, $3,$4\n\t\t\t) ON CONFLICT (mac) DO NOTHING;\n\t\t","time":22075792,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:51:03.272Z","msg":"Prepare","name":"SqlQueryAppsList","sql":"\n\t\t      \tSELECT\n\t\t\t\t\tf.id,\n\t\t\t\t\tf.app_name,\n\t\t\t\t\tf.app_description :: TEXT,\n\t\t\t\t\tf.app_icon,\n\t\t\t\t\tf.app_sort,\n\t\t\t\t\tf.app_banner,\n\t\t\t\t\tf.app_carousel,\n\t\t\t\t\tf.system_requirement :: TEXT,\n\t\t\t\t\tf.rating,\n\t\t\t\t\tf.copyright_notice :: TEXT,\n\t\t\t\t\tf.category_ids,\n\t\t\t\t\tf.price_plan_ids,\n\t\t\t\t\tf.distributor_id :: TEXT,\n\t\t\t\t\tf.model_id :: TEXT,\n\t\t\t\t\tARRAY_AGG(DISTINCT c.category_name) AS categories_name,\n\t\t\t\t\tARRAY_AGG(DISTINCT p.plan_name) AS price_plans_name,\n\t\t\t\t\tm.name AS model_name,\n\t\t\t\t\td.title AS distributor_name,\n\t\t\t\t\tf.class,\n\t\t\t\t\tf.is_show_on_market,\n\t\t\t\t\tf.is_show_tool_tip,\n\t\t\t\t\tf.catpromo,\n\t\t\t\t\tf.category_id\n\t\t\t\tFROM\n\t\t\t\t\twst.apps f\n\t\t\t\tJOIN\n\t\t\t\t\twst.distributor d ON f.distributor_id = d.id\n\t\t\t\tJOIN\n\t\t\t\t\twst.model m ON f.model_id = m.id\n\t\t\t\tLEFT JOIN\n\t\t\t\t\twst.categories c ON c.id = ANY(f.category_ids)\n\t\t\t\tLEFT JOIN\n\t\t\t\t\twst.price_plans p ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tWHERE\n\t\t\t\t\tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.app_name ILIKE '%' ||$3 || '%' END\n    \t\t\t\tAND (CASE WHEN $4 = 0 THEN TRUE ELSE $4::BIGINT = ANY(f.category_ids) END)\n\t\t\t\t\tAND f.deleted = FALSE\n\t\t\t\tGROUP BY\n\t\t\t\t\tf.id, f.app_name, f.app_description, f.app_icon, f.app_sort, f.app_banner, f.app_carousel,\n\t\t\t\t\tf.system_requirement, f.rating, f.copyright_notice, f.category_ids, f.price_plan_ids,\n\t\t\t\t\tf.distributor_id, f.model_id, m.name, d.title, f.class, f.is_show_on_market, f.is_show_tool_tip\n\t\t\t\t\tLIMIT $5 OFFSET $6;\n\t\t","time":17810581,"alreadyPrepared":false,"pid":2997959}
{"level":"debug","time":"2024-10-30T05:54:00.039Z","msg":"logger init ok"}
{"level":"debug","time":"2024-10-30T05:54:00.116Z","msg":"try to connect redis"}
{"level":"info","time":"2024-10-30T05:54:00.116Z","name":"Cache.NewCache","msg":"connect to redis","addr":"47.120.68.50:6059"}
{"level":"info","time":"2024-10-30T05:54:00.249Z","name":"ConnectRedis","msg":"connect redis success"}
{"level":"info","time":"2024-10-30T05:54:00.302Z","name":"Cache.NewCache","msg":"connect to redis success"}
{"level":"debug","time":"2024-10-30T05:54:00.318Z","msg":"connect to redis success"}
{"level":"debug","time":"2024-10-30T05:54:00.318Z","msg":"-----------------service success-------------------------"}
{"level":"debug","time":"2024-10-30T05:54:00.318Z","name":"rpc Serve","msg":"try to serve"}
{"level":"info","time":"2024-10-30T05:54:00.478Z","msg":"Connect","pid":3000916,"host":"47.120.68.50","port":6008,"database":"rdb","time":358174457}
{"level":"info","time":"2024-10-30T05:54:00.499Z","msg":"Prepare","name":"SqlFindDistributorModelByMacInAccount","sql":"\n\t\t\t(SELECT distributor_id, model_id FROM rja.account WHERE mac_string = $1 AND is_active = true )\n\t\t\tUNION ALL\n\t\t\t(SELECT distributor_id, model_id FROM tv_rja.account WHERE mac_string = $1 AND is_active = true);\n\t\t","time":19787479,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.511Z","msg":"Prepare","alreadyPrepared":false,"pid":3000916,"name":"SqlCountAppsVersionList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.app_version \n\t\t\twhere deleted = false;\n\t\t","time":12434760}
{"level":"info","time":"2024-10-30T05:54:00.533Z","msg":"Prepare","time":21580239,"alreadyPrepared":false,"pid":3000916,"name":"SqlUpdateAppsVersionIsLatest","sql":"\n\t\t\tUPDATE wst.app_version \n\t\t\tSET is_latest = false \n\t\t\tWHERE app_id = $1;\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:00.555Z","msg":"Prepare","pid":3000916,"name":"SqlFindAppsVersion","sql":"\n\t\t\tUPDATE wst.app_version \n\t\t\tSET is_latest = TRUE \n\t\t\tWHERE\n\t\t\tdate_released = ( SELECT MAX(date_released) FROM wst.app_version WHERE app_id = $1 AND is_latest = FALSE) \n\t\t\tAND app_id = $1;\n\t\t","time":21781239,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:54:00.568Z","msg":"Prepare","sql":"\n\t\t\tselect f.id,\n\t\t\t       f.app_id,\n\t\t\t       f.version_name,\n\t\t\t       f.date_released,\n\t\t\t       f.changelog,\n\t\t\t       f.is_latest,\n\t\t\t       f.is_public,\n\t\t\t       f.is_paid,\n\t\t\t       f.filesize,\n\t\t\t       f.md5,\n\t\t\t       f.url,\n\t\t\t       f.force_uninstall,\n\t\t\t       f.filesize \n\t\t\tfrom wst.app_version f \n\t\t\twhere f.deleted = false \n\t\t\tand f.app_id = $1::int  \n\t\t\tlimit $2 offset $3;\n\t\t","time":12952411,"alreadyPrepared":false,"pid":3000916,"name":"SqlQueryAppsVersionList"}
{"level":"info","time":"2024-10-30T05:54:00.598Z","msg":"Prepare","name":"SqlQueryApps","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON  c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.app_name ILIKE $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t\tORDER BY \n\t\t\t    CAST(app_sort AS INTEGER) ASC;\n\t\t","time":30383369,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.616Z","msg":"Prepare","name":"SqlQueryAppsNewestVersion","sql":"\n\t\t\tSELECT DISTINCT ON (f.ID)\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids) \n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND V.\"class\" = $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t","time":18159462,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.629Z","msg":"Prepare","pid":3000916,"name":"SqlQueryAppUserByMac","sql":"SELECT user_name,password,mac,ip,country,city,distributor_id,model_id,last_login,is_active,is_service,is_expired FROM wst.app_user WHERE mac = $1 AND deleted = false;","time":12426830,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:54:00.654Z","msg":"Prepare","sql":"\n\t\t      \tSELECT\n\t\t\t\t\tf.id,\n\t\t\t\t\tf.app_name,\n\t\t\t\t\tf.app_description :: TEXT,\n\t\t\t\t\tf.app_icon,\n\t\t\t\t\tf.app_sort,\n\t\t\t\t\tf.app_banner,\n\t\t\t\t\tf.app_carousel,\n\t\t\t\t\tf.system_requirement :: TEXT,\n\t\t\t\t\tf.rating,\n\t\t\t\t\tf.copyright_notice :: TEXT,\n\t\t\t\t\tf.category_ids,\n\t\t\t\t\tf.price_plan_ids,\n\t\t\t\t\tf.distributor_id :: TEXT,\n\t\t\t\t\tf.model_id :: TEXT,\n\t\t\t\t\tARRAY_AGG(DISTINCT c.category_name) AS categories_name,\n\t\t\t\t\tARRAY_AGG(DISTINCT p.plan_name) AS price_plans_name,\n\t\t\t\t\tm.name AS model_name,\n\t\t\t\t\td.title AS distributor_name,\n\t\t\t\t\tf.class,\n\t\t\t\t\tf.is_show_on_market,\n\t\t\t\t\tf.is_show_tool_tip,\n\t\t\t\t\tf.catpromo,\n\t\t\t\t\tf.category_id\n\t\t\t\tFROM\n\t\t\t\t\twst.apps f\n\t\t\t\tJOIN\n\t\t\t\t\twst.distributor d ON f.distributor_id = d.id\n\t\t\t\tJOIN\n\t\t\t\t\twst.model m ON f.model_id = m.id\n\t\t\t\tLEFT JOIN\n\t\t\t\t\twst.categories c ON c.id = ANY(f.category_ids)\n\t\t\t\tLEFT JOIN\n\t\t\t\t\twst.price_plans p ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tWHERE\n\t\t\t\t\tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.app_name ILIKE '%' ||$3 || '%' END\n    \t\t\t\tAND (CASE WHEN $4 = 0 THEN TRUE ELSE $4::BIGINT = ANY(f.category_ids) END)\n\t\t\t\t\tAND f.deleted = FALSE\n\t\t\t\tGROUP BY\n\t\t\t\t\tf.id, f.app_name, f.app_description, f.app_icon, f.app_sort, f.app_banner, f.app_carousel,\n\t\t\t\t\tf.system_requirement, f.rating, f.copyright_notice, f.category_ids, f.price_plan_ids,\n\t\t\t\t\tf.distributor_id, f.model_id, m.name, d.title, f.class, f.is_show_on_market, f.is_show_tool_tip\n\t\t\t\t\tLIMIT $5 OFFSET $6;\n\t\t","time":25397968,"alreadyPrepared":false,"pid":3000916,"name":"SqlQueryAppsList"}
{"level":"info","time":"2024-10-30T05:54:00.671Z","msg":"Prepare","pid":3000916,"name":"SqlQueryAppVersionIsLatestByAppId","sql":"\n\t\t\t\t\t\tSelect \n\t\t\t\t\t\t version_name,\n\t\t\t\t\t\t changelog,\n\t\t\t\t\t\t is_latest,\n\t\t\t\t\t\t is_public,\n\t\t\t\t\t\t is_paid,\n\t\t\t\t\t\t filesize,\n\t\t\t\t\t\t md5,\n\t\t\t\t\t\t url,\n\t\t\t\t\t\t force_uninstall,\n\t\t\t\t\t\t class\n\t\t\t\t FROM wst.app_version\n  \t\t\t\t WHERE app_id = $1\n\t\t\t\t AND deleted = false\n\t\t\t     AND is_latest = true;\n\t\t","time":16800692,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:54:00.683Z","msg":"Prepare","alreadyPrepared":false,"pid":3000916,"name":"SqlUpdateAppUser","sql":"\n\t\t\tupdate wst.app_user \n\t\t\tset user_name = $1, \n\t\t\t    password = $2, \n\t\t\t    ip = $3, \n\t\t\t    country = $4, \n\t\t\t    city = $5, \n\t\t\t    distributor_id = $6, \n\t\t\t    model_id = $7, \n\t\t\t    deleted = $8,\n\t\t\t    is_active = $9,\n\t\t\t    is_service = $10,\n\t\t\t    is_expired = $11\n\t\t\tWHERE mac = $12;\n\t\t","time":11930069}
{"level":"info","time":"2024-10-30T05:54:00.722Z","msg":"Prepare","name":"SqlDeleteAppUser","sql":"\n\t\t\tDELETE FROM wst.app_user WHERE mac = $1;\n\t\t","time":38321668,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.736Z","msg":"Prepare","name":"SqlUpdateAppsVersion","sql":"\n\t\t\tupdate wst.app_version \n\t\t\tset version_name = $1,\n\t\t\tchangelog = $2,\n\t\t\tis_latest = $3,\n\t\t\tis_paid = $4,\n\t\t\tfilesize = $5,\n\t\t\tmd5 = $6,\n\t\t\turl = $7,\n\t\t\tforce_uninstall = $8,\n\t\t\tdeleted = $9,\n\t\t\tis_public = $10\n\t\t\twhere id = $11;\n\t\t","time":14159215,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.748Z","msg":"Prepare","name":"SqlInsertCategories","sql":"insert into wst.categories (category_name,distributor_id,model_id,sort) values ($1,$2,$3,$4);","time":11724591,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.759Z","msg":"Prepare","name":"SqlUpdateSelf","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND V.\"class\" = $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t","time":10956690,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.800Z","msg":"Prepare","time":40000209,"alreadyPrepared":false,"pid":3000916,"name":"GetAppsForPushDesktop","sql":"\n\t\t\tSELECT  DISTINCT ON (f.category_id)\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo,\n\t\t\t\tf.category_id AS categories_id\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND f.distributor_id = $1::bigint\n\t\t\t\tAND f.model_id = $2::bigint\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.is_show_tool_tip = 1\n\t\t\tORDER BY\n    \t\t\tf.category_id ASC -- 分类 ID 排序\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:00.830Z","msg":"Prepare","name":"SqlGetAppsCategories","sql":"\n\t\t\tSELECT id,category_name \n\t\t\tFROM wst.categories \n\t\t\tWHERE distributor_id = $1\n\t\t\tAND model_id = $2\n\t\t\tAND deleted = FALSE \n\t\t\tORDER BY sort ;\n\t\t","time":21921108,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.842Z","msg":"Prepare","name":"SqlCountAppUserList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.app_user f\n\t\t\twhere CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.mac ILIKE '%' ||$3 || '%' END\n\t\t\tAND f.deleted = FALSE\n\t\t","time":12294177,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.853Z","msg":"Prepare","pid":3000916,"name":"SqlUpdateCategories","sql":"update wst.categories set category_name = $1,deleted = $2,distributor_id = $3,model_id = $4,sort = $5 where id = $6;","time":10304425,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:54:00.863Z","msg":"Prepare","time":9957956,"alreadyPrepared":false,"pid":3000916,"name":"SqlCountPricePlanList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.price_plans \n\t\t\twhere deleted = false;\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:00.880Z","msg":"Prepare","time":17316512,"alreadyPrepared":false,"pid":3000916,"name":"SqlQueryAllPricePlan","sql":"\n\t\t\tSELECT \n\t\t\t\tC.ID AS id, \n\t\t\t\tCONCAT(C.plan_name, ' - ', d.title, ' - ', M.NAME) AS label \n\t\t\tFROM \n\t\t\t\twst.price_plans C \n\t\t\t\tLEFT JOIN wst.distributor d ON C.distributor_id = d.ID \n\t\t\t\tLEFT JOIN wst.model M ON C.model_id = M.ID;\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:00.902Z","msg":"Prepare","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo,\n\t\t\t\tf.category_id AS categories_id\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND $1 = ANY(f.category_ids)\n\t\t\t  \tAND c.id =  $1\n\t\t\t\tAND f.distributor_id = $2::bigint\n\t\t\t\tAND f.model_id = $3::bigint\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.is_show_on_market = 1\n\t\t\tORDER BY\n\t\t\t\t  CAST(app_sort AS INTEGER) ASC;\n\t\t","time":21757750,"alreadyPrepared":false,"pid":3000916,"name":"SqlGetAppsByCategories"}
{"level":"info","time":"2024-10-30T05:54:00.916Z","msg":"Prepare","name":"SqlCountAppsList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.apps f\n\t\t\twhere CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.app_name ILIKE '%' ||$3 || '%' END\n    \t\tAND (CASE WHEN $4 = 0 THEN TRUE ELSE $4::BIGINT = ANY(f.category_ids) END)\n\t\t\tAND f.deleted = FALSE\n\t\t","time":14275173,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:00.928Z","msg":"Prepare","pid":3000916,"name":"SqlUpdateApps","sql":"\n\t\t\tupdate wst.apps \n\t\t\tset app_name = $1,\n\t\t\t    app_description = $2,\n\t\t\t    app_icon = $3,\n\t\t\t    app_carousel = $4,\n\t\t\t    app_sort = $5,\n\t\t\t    app_banner = $6,\n\t\t\t    system_requirement = $7,\n\t\t\t    rating = $8,\n\t\t\t    class = $9,\n\t\t\t    copyright_notice = $10,\n\t\t\t    category_ids = $11,\n\t\t\t    price_plan_ids = $12,\n\t\t\t    is_show_on_market = $13,\n\t\t\t    is_show_tool_tip = $14,\n\t\t\t    distributor_id = $15,\n\t\t\t    model_id = $16,\n\t\t\t    deleted = $17,\n\t\t\t    catpromo =$18,\n\t\t\t    category_id = $19\n\t\t\tWHERE id = $20;\n\t\t","time":11873824,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:54:00.939Z","msg":"Prepare","alreadyPrepared":false,"pid":3000916,"name":"SqlCheckAppCategories","sql":"\n\t\t\t\tSELECT category_name\n\t\t\t\t FROM wst.categories\n  \t\t\t\t WHERE id = ANY($1)\n\t\t\t\t AND distributor_id = $2\n\t\t\t\t AND model_id = $3\n\t\t","time":9708056}
{"level":"info","time":"2024-10-30T05:54:00.949Z","msg":"Prepare","alreadyPrepared":false,"pid":3000916,"name":"SqlInsertAppUser","sql":"\n\t\t\tINSERT INTO wst.app_user (\n\t\t\t\tuser_name, \n\t\t\t\tPASSWORD, \n\t\t\t\tmac, \n\t\t\t\tip, \n\t\t\t\tcountry, \n\t\t\t\tcity, \n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id, \n\t\t\t\tlast_login, \n\t\t\t\toperator, \n\t\t\t\tdeleted,\n\t\t\t\tis_active,\n\t\t\t  \tis_expired,\n\t\t\t    is_service                      \n\t\t\t) VALUES (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12,$13,$14\n\t\t\t) ON CONFLICT (mac) DO NOTHING\n\t\t\tRETURNING user_name, PASSWORD, mac, ip, country, city, distributor_id, model_id, last_login, operator;\n\t\t","time":9824658}
{"level":"info","time":"2024-10-30T05:54:00.963Z","msg":"Prepare","time":14398877,"alreadyPrepared":false,"pid":3000916,"name":"SqlFindDistributorModelByMacInTerminal","sql":"\n\t\t\t(SELECT is_used FROM rja.terminal WHERE mac_string = $1 )\n\t\t\tUNION ALL\n\t\t\t(SELECT is_used FROM tv_rja.terminal WHERE mac_string = $1);\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:00.978Z","msg":"Prepare","sql":"\n\t\t\tinsert into wst.app_version (\n\t\t\t\tapp_id,\n\t\t\t\tversion_name,\n\t\t\t\tdate_released,\n\t\t\t\tchangelog,\n\t\t\t\tis_latest,\n\t\t\t\tis_public,\n\t\t\t\tis_paid,\n\t\t\t\tfilesize,\n\t\t\t\tmd5,\n\t\t\t\turl,\n\t\t\t\tforce_uninstall,\n\t\t\t\tdeleted,\n\t\t\t\tclass\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13\n\t\t\t);\n\t\t","time":14938566,"alreadyPrepared":false,"pid":3000916,"name":"SqlInsertAppsVersion"}
{"level":"info","time":"2024-10-30T05:54:01.002Z","msg":"Prepare","name":"SqlInsertApps","sql":"\n\t\t\tinsert into wst.apps (\n\t\t\t\tapp_name,\n\t\t\t\tapp_description,\n\t\t\t\tapp_icon,\n\t\t\t\tapp_carousel,\n\t\t\t\tapp_sort,\n\t\t\t\tapp_banner,\n\t\t\t\tsystem_requirement,\n\t\t\t\trating,\n\t\t\t\tcopyright_notice,\n\t\t\t\tdistributor_id,\n\t\t\t\tmodel_id,\n\t\t\t\tdeleted,\n\t\t\t\tprice_plan_ids,\n\t\t\t\tclass,\n\t\t\t\tcategory_ids,\n\t\t\t\tis_show_on_market,\n\t\t\t\tis_show_tool_tip,\n\t\t\t    catpromo,\n\t\t\t    category_id               \n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13,$14, $15,$16, $17, $18,$19\n\t\t\t);\n\t\t","time":23862314,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.058Z","msg":"Prepare","name":"SqlCheckAppUniqueByUpdate","sql":"\n\t\t\tselect id\n\t\t\tfrom wst.apps\n\t\t\twhere class = $1\n\t\t\t  AND distributor_id = $2\n\t\t\t  AND model_id = $3\n\t\t\t  AND deleted = false\n\t\t\t;\n\t\t","time":55862221,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.069Z","msg":"Prepare","alreadyPrepared":false,"pid":3000916,"name":"SqlQueryAppUserList","sql":"\n\t\t\tSELECT\n\t\t\t\tf.user_name,\n\t\t\t\tf.PASSWORD,\n\t\t\t\tf.mac,\n\t\t\t\tf.ip,\n\t\t\t\tf.country,\n\t\t\t\tf.city,\n\t\t\t\tf.last_login,\n\t\t\t\tf.OPERATOR,\n\t\t\t\tf.distributor_id,\n\t\t\t\tf.model_id,\n\t\t\t\td.title :: TEXT AS distributorName,\n\t\t\t\tM.NAME :: TEXT AS modelName,\n\t\t\t\tf.is_active,\n\t\t\t    f.is_service,\n\t\t\t    f.is_expired\n\t\t\tFROM\n\t\t\t\twst.app_user f\n\t\t\t\tJOIN wst.distributor d ON f.distributor_id = d.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID \n\t\t\twhere \n\t\t\t    CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.mac ILIKE '%' ||$3 || '%' END\n\t\t\t\tAND f.deleted = FALSE\n\t\t\tLIMIT $4 OFFSET $5;\n\t\t","time":10410658}
{"level":"info","time":"2024-10-30T05:54:01.081Z","msg":"Prepare","name":"SqlUpdatePricePlan","sql":"\n\t\t\tupdate wst.price_plans \n\t\t\tset plan_name = $1, \n\t\t\t    plan_description = $2, \n\t\t\t    billing_cycle = $3, \n\t\t\t    trial_period = $4, \n\t\t\t    price = $5, \n\t\t\t    distributor_id = $6, \n\t\t\t    model_id = $7, \n\t\t\t    deleted = $8 \n\t\t\twhere id = $9;\n\t\t","time":12679301,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.105Z","msg":"Prepare","time":10122422,"alreadyPrepared":false,"pid":3000916,"name":"SqlQueryPricePlanList","sql":"\n\t\t\tselect \n\t\t\t\tf.id, \n\t\t\t\tf.plan_name, \n\t\t\t\tf.plan_description, \n\t\t\t\tf.billing_cycle, \n\t\t\t\tf.trial_period, \n\t\t\t\tf.price, \n\t\t\t\tf.distributor_id, \n\t\t\t\tf.model_id, \n\t\t\t\td.title as distributorName, \n\t\t\t\tm.name as modelName \n\t\t\tfrom \n\t\t\t\twst.price_plans f \n\t\t\t\tjoin wst.distributor d on f.distributor_id = d.id \n\t\t\t\tjoin wst.model m on f.model_id = m.id \n\t\t\twhere \n\t\t\t\tf.deleted = false \n\t\t\tlimit $1 offset $2;\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:01.117Z","msg":"Prepare","name":"SqlGetCategoriesByClass","sql":"\n\t\t\tSELECT \n\t\t\t\tcategory_ids \n\t\t\tFROM \n\t\t\t\twst.apps \n\t\t\tWHERE \n\t\t\t\tclass = $1 AND distributor_id =$2 AND model_id = $3;\n\t\t","time":12434557,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.130Z","msg":"Prepare","time":12658329,"alreadyPrepared":false,"pid":3000916,"name":"SqlInsertFailureRecord","sql":"\n\t\t\tINSERT INTO wst.failure_log (\n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id, \n\t\t\t\tmac, \n\t\t\t\tdeleted\n\t\t\t) VALUES (\n\t\t\t\t$1,$2, $3,$4\n\t\t\t) ON CONFLICT (mac) DO NOTHING;\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:01.147Z","msg":"Prepare","sql":"\n\t\t\tSELECT url \n\t\t\tFROM wst.app_version \n\t\t\tWHERE app_id = $1 AND is_latest = TRUE AND deleted = false;\n\t\t","time":17311691,"alreadyPrepared":false,"pid":3000916,"name":"SqlGetAppDownloadUrl"}
{"level":"info","time":"2024-10-30T05:54:01.178Z","msg":"Prepare","name":"SqlInsertAppByCopy","sql":"\n\t\t\tinsert into wst.apps (\n\t\t\t\tapp_name,\n\t\t\t\tapp_description,\n\t\t\t\tapp_icon,\n\t\t\t\tapp_carousel,\n\t\t\t\tapp_sort,\n\t\t\t\tapp_banner,\n\t\t\t\tsystem_requirement,\n\t\t\t\trating,\n\t\t\t\tcopyright_notice,\n\t\t\t\tdistributor_id,\n\t\t\t\tmodel_id,\n\t\t\t\tdeleted,\n\t\t\t\tprice_plan_ids,\n\t\t\t\tclass,\n\t\t\t\tcategory_ids,\n\t\t\t\tis_show_on_market,\n\t\t\t\tis_show_tool_tip,\n\t\t\t    catpromo\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13,$14, $15,$16, $17, $18\n\t\t\t) RETURNING  id;\n\t\t","time":31015686,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.190Z","msg":"Prepare","time":11736852,"alreadyPrepared":false,"pid":3000916,"name":"SqlCheckAppUniqueByAdd","sql":"\n\t\t\tselect count(id)\n\t\t\tfrom wst.apps\n\t\t\twhere class = $1\n\t\t\t  AND distributor_id = $2\n\t\t\t  AND model_id = $3\n\t\t\t  AND deleted = false\n\t\t\t;\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:01.202Z","msg":"Prepare","time":11791719,"alreadyPrepared":false,"pid":3000916,"name":"SqlDeleteApps","sql":"\n\t\t\t\t\t\tDelete \n\t\t\t\t FROM wst.apps\n  \t\t\t\t WHERE id = $1\n\t\t"}
{"level":"info","time":"2024-10-30T05:54:01.213Z","msg":"Prepare","name":"SqlInsertPricePlan","sql":"\n\t\t\tinsert into wst.price_plans (\n\t\t\t\tplan_name, \n\t\t\t\tplan_description, \n\t\t\t\tbilling_cycle, \n\t\t\t\ttrial_period, \n\t\t\t\tprice, \n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7\n\t\t\t);\n\t\t","time":10896013,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.288Z","msg":"Prepare","name":"SqlCheckAppPrice","sql":"\n\t\t\t\t\t\tSELECT plan_name\n\t\t\t\t FROM wst.price_plans\n  \t\t\t\t WHERE id = ANY($1::int[])\n\t\t\t\t AND distributor_id = $2\n\t\t\t\t AND model_id = $3\n\t\t","time":75026472,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.309Z","msg":"Prepare","sql":"\n\t\t\t\t\t\tDelete \n\t\t\t\t FROM wst.app_version\n  \t\t\t\t WHERE app_id = $1\n\t\t","time":20596486,"alreadyPrepared":false,"pid":3000916,"name":"SqlDeleteAppsVersion"}
{"level":"info","time":"2024-10-30T05:54:01.320Z","msg":"Prepare","name":"SqlCountCategoriesList","sql":"select count(id) as total from wst.categories f where \n\t\t\t\t\t\t\t  \tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\t\t\t\tAND f.deleted = FALSE;","time":11166933,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.348Z","msg":"Prepare","name":"SqlQueryCategoriesList","sql":"\n\t\t\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\t\tf.id,\n\t\t\t\t\t\t\t\t\tf.category_name,\n\t\t\t\t\t\t\t\t\tf.distributor_id,\n\t\t\t\t\t\t\t\t\tf.model_id,\n\t\t\t\t\t\t\t\t\td.title ::text AS distributorName,\n\t\t\t\t\t\t\t\t\tM.NAME ::text AS modelName,\n\t\t\t\t\t\t\t\t\tf.sort\n\t\t\t\t\t\t\t\tFROM\n\t\t\t\t\t\t\t\t\twst.categories f\n\t\t\t\t\t\t\t\t\tJOIN wst.distributor d ON f.distributor_id  = d.id\n\t\t\t\t\t\t\t\t\tJOIN wst.model M ON f.model_id = M.ID \n\t\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\t\t\t\tAND f.deleted = FALSE\n\t\t\t\t\t\t\t\tLIMIT $3 OFFSET $4;","time":27630374,"alreadyPrepared":false,"pid":3000916}
{"level":"info","time":"2024-10-30T05:54:01.389Z","msg":"Prepare","time":31624478,"alreadyPrepared":false,"pid":3000916,"name":"SqlQueryAllCategories","sql":"\n\t\t\tSELECT \n\t\t\t\tC.ID AS category_ids,\n\t\t\t\tCONCAT(C.category_name, ' - ', d.title, ' - ', M.NAME) AS label \n\t\t\tFROM \n\t\t\t\twst.categories C \n\t\t\t\tLEFT JOIN wst.distributor d ON C.distributor_id = d.ID \n\t\t\t\tLEFT JOIN wst.model M ON C.model_id = M.ID\n\t\t\t\tWhere c.deleted = false\n\t\t\t;\n\t\t"}
{"level":"debug","time":"2024-10-30T05:59:54.110Z","msg":"logger init ok"}
{"level":"debug","time":"2024-10-30T05:59:54.148Z","msg":"try to connect redis"}
{"level":"info","time":"2024-10-30T05:59:54.148Z","name":"Cache.NewCache","msg":"connect to redis","addr":"47.120.68.50:6059"}
{"level":"info","time":"2024-10-30T05:59:54.241Z","name":"ConnectRedis","msg":"connect redis success"}
{"level":"info","time":"2024-10-30T05:59:54.299Z","name":"Cache.NewCache","msg":"connect to redis success"}
{"level":"debug","time":"2024-10-30T05:59:54.299Z","msg":"connect to redis success"}
{"level":"debug","time":"2024-10-30T05:59:54.299Z","msg":"-----------------service success-------------------------"}
{"level":"debug","time":"2024-10-30T05:59:54.299Z","name":"rpc Serve","msg":"try to serve"}
{"level":"info","time":"2024-10-30T05:59:54.305Z","msg":"Connect","host":"47.120.68.50","port":6008,"database":"rdb","time":151720838,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.329Z","msg":"Prepare","time":23299165,"alreadyPrepared":false,"pid":3006498,"name":"SqlCheckAppPrice","sql":"\n\t\t\t\t\t\tSELECT plan_name\n\t\t\t\t FROM wst.price_plans\n  \t\t\t\t WHERE id = ANY($1::int[])\n\t\t\t\t AND distributor_id = $2\n\t\t\t\t AND model_id = $3\n\t\t"}
{"level":"info","time":"2024-10-30T05:59:54.370Z","msg":"Prepare","name":"SqlGetAppsCategories","sql":"\n\t\t\tSELECT id,category_name \n\t\t\tFROM wst.categories \n\t\t\tWHERE distributor_id = $1\n\t\t\tAND model_id = $2\n\t\t\tAND deleted = FALSE \n\t\t\tORDER BY sort ;\n\t\t","time":41277980,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.394Z","msg":"Prepare","name":"SqlQueryCategoriesList","sql":"\n\t\t\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\t\tf.id,\n\t\t\t\t\t\t\t\t\tf.category_name,\n\t\t\t\t\t\t\t\t\tf.distributor_id,\n\t\t\t\t\t\t\t\t\tf.model_id,\n\t\t\t\t\t\t\t\t\td.title ::text AS distributorName,\n\t\t\t\t\t\t\t\t\tM.NAME ::text AS modelName,\n\t\t\t\t\t\t\t\t\tf.sort\n\t\t\t\t\t\t\t\tFROM\n\t\t\t\t\t\t\t\t\twst.categories f\n\t\t\t\t\t\t\t\t\tJOIN wst.distributor d ON f.distributor_id  = d.id\n\t\t\t\t\t\t\t\t\tJOIN wst.model M ON f.model_id = M.ID \n\t\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\t\t\t\tAND f.deleted = FALSE\n\t\t\t\t\t\t\t\tLIMIT $3 OFFSET $4;","time":23462443,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.409Z","msg":"Prepare","alreadyPrepared":false,"pid":3006498,"name":"SqlCountAppsList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.apps f\n\t\t\twhere CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.app_name ILIKE '%' ||$3 || '%' END\n    \t\tAND (CASE WHEN $4 = 0 THEN TRUE ELSE $4::BIGINT = ANY(f.category_ids) END)\n\t\t\tAND f.deleted = FALSE\n\t\t","time":14496834}
{"level":"info","time":"2024-10-30T05:59:54.436Z","msg":"Prepare","name":"SqlCheckAppCategories","sql":"\n\t\t\t\tSELECT category_name\n\t\t\t\t FROM wst.categories\n  \t\t\t\t WHERE id = ANY($1)\n\t\t\t\t AND distributor_id = $2\n\t\t\t\t AND model_id = $3\n\t\t","time":26907270,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.479Z","msg":"Prepare","name":"SqlFindDistributorModelByMacInAccount","sql":"\n\t\t\t(SELECT distributor_id, model_id FROM rja.account WHERE mac_string = $1 AND is_active = true )\n\t\t\tUNION ALL\n\t\t\t(SELECT distributor_id, model_id FROM tv_rja.account WHERE mac_string = $1 AND is_active = true);\n\t\t","time":42978935,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.501Z","msg":"Prepare","name":"SqlUpdateAppsVersion","sql":"\n\t\t\tupdate wst.app_version \n\t\t\tset version_name = $1,\n\t\t\tchangelog = $2,\n\t\t\tis_latest = $3,\n\t\t\tis_paid = $4,\n\t\t\tfilesize = $5,\n\t\t\tmd5 = $6,\n\t\t\turl = $7,\n\t\t\tforce_uninstall = $8,\n\t\t\tdeleted = $9,\n\t\t\tis_public = $10\n\t\t\twhere id = $11;\n\t\t","time":21956535,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.513Z","msg":"Prepare","name":"SqlUpdateAppsVersionIsLatest","sql":"\n\t\t\tUPDATE wst.app_version \n\t\t\tSET is_latest = false \n\t\t\tWHERE app_id = $1;\n\t\t","time":11523330,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.544Z","msg":"Prepare","name":"SqlQueryApps","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON  c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.app_name ILIKE $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t\tORDER BY \n\t\t\t    CAST(app_sort AS INTEGER) ASC;\n\t\t","time":31612974,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.562Z","msg":"Prepare","name":"GetAppsForPushDesktop","sql":"\n\t\t\tSELECT  DISTINCT ON (f.category_id)\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo,\n\t\t\t\tf.category_id AS categories_id\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND f.distributor_id = $1::bigint\n\t\t\t\tAND f.model_id = $2::bigint\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.is_show_tool_tip = 1\n\t\t\tORDER BY\n    \t\t\tf.category_id ASC -- 分类 ID 排序\n\t\t","time":18058467,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.575Z","msg":"Prepare","name":"SqlGetCategoriesByClass","sql":"\n\t\t\tSELECT \n\t\t\t\tcategory_ids \n\t\t\tFROM \n\t\t\t\twst.apps \n\t\t\tWHERE \n\t\t\t\tclass = $1 AND distributor_id =$2 AND model_id = $3;\n\t\t","time":12722127,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.587Z","msg":"Prepare","alreadyPrepared":false,"pid":3006498,"name":"SqlUpdateApps","sql":"\n\t\t\tupdate wst.apps \n\t\t\tset app_name = $1,\n\t\t\t    app_description = $2,\n\t\t\t    app_icon = $3,\n\t\t\t    app_carousel = $4,\n\t\t\t    app_sort = $5,\n\t\t\t    app_banner = $6,\n\t\t\t    system_requirement = $7,\n\t\t\t    rating = $8,\n\t\t\t    class = $9,\n\t\t\t    copyright_notice = $10,\n\t\t\t    category_ids = $11,\n\t\t\t    price_plan_ids = $12,\n\t\t\t    is_show_on_market = $13,\n\t\t\t    is_show_tool_tip = $14,\n\t\t\t    distributor_id = $15,\n\t\t\t    model_id = $16,\n\t\t\t    deleted = $17,\n\t\t\t    catpromo =$18,\n\t\t\t    category_id = $19\n\t\t\tWHERE id = $20;\n\t\t","time":11625069}
{"level":"info","time":"2024-10-30T05:59:54.613Z","msg":"Prepare","name":"SqlQueryAppsList","sql":"\n\t\t      \tSELECT\n\t\t\t\t\tf.id,\n\t\t\t\t\tf.app_name,\n\t\t\t\t\tf.app_description :: TEXT,\n\t\t\t\t\tf.app_icon,\n\t\t\t\t\tf.app_sort,\n\t\t\t\t\tf.app_banner,\n\t\t\t\t\tf.app_carousel,\n\t\t\t\t\tf.system_requirement :: TEXT,\n\t\t\t\t\tf.rating,\n\t\t\t\t\tf.copyright_notice :: TEXT,\n\t\t\t\t\tf.category_ids,\n\t\t\t\t\tf.price_plan_ids,\n\t\t\t\t\tf.distributor_id :: TEXT,\n\t\t\t\t\tf.model_id :: TEXT,\n\t\t\t\t\tARRAY_AGG(DISTINCT c.category_name) AS categories_name,\n\t\t\t\t\tARRAY_AGG(DISTINCT p.plan_name) AS price_plans_name,\n\t\t\t\t\tm.name AS model_name,\n\t\t\t\t\td.title AS distributor_name,\n\t\t\t\t\tf.class,\n\t\t\t\t\tf.is_show_on_market,\n\t\t\t\t\tf.is_show_tool_tip,\n\t\t\t\t\tf.catpromo,\n\t\t\t\t\tf.category_id\n\t\t\t\tFROM\n\t\t\t\t\twst.apps f\n\t\t\t\tJOIN\n\t\t\t\t\twst.distributor d ON f.distributor_id = d.id\n\t\t\t\tJOIN\n\t\t\t\t\twst.model m ON f.model_id = m.id\n\t\t\t\tLEFT JOIN\n\t\t\t\t\twst.categories c ON c.id = ANY(f.category_ids)\n\t\t\t\tLEFT JOIN\n\t\t\t\t\twst.price_plans p ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tWHERE\n\t\t\t\t\tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.app_name ILIKE '%' ||$3 || '%' END\n    \t\t\t\tAND (CASE WHEN $4 = 0 THEN TRUE ELSE $4::BIGINT = ANY(f.category_ids) END)\n\t\t\t\t\tAND f.deleted = FALSE\n\t\t\t\tGROUP BY\n\t\t\t\t\tf.id, f.app_name, f.app_description, f.app_icon, f.app_sort, f.app_banner, f.app_carousel,\n\t\t\t\t\tf.system_requirement, f.rating, f.copyright_notice, f.category_ids, f.price_plan_ids,\n\t\t\t\t\tf.distributor_id, f.model_id, m.name, d.title, f.class, f.is_show_on_market, f.is_show_tool_tip\n\t\t\t\t\tLIMIT $5 OFFSET $6;\n\t\t","time":26188439,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.645Z","msg":"Prepare","name":"SqlFindDistributorModelByMacInTerminal","sql":"\n\t\t\t(SELECT is_used FROM rja.terminal WHERE mac_string = $1 )\n\t\t\tUNION ALL\n\t\t\t(SELECT is_used FROM tv_rja.terminal WHERE mac_string = $1);\n\t\t","time":32079398,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.658Z","msg":"Prepare","name":"SqlCountAppsVersionList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.app_version \n\t\t\twhere deleted = false;\n\t\t","time":12285185,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.680Z","msg":"Prepare","name":"SqlFindAppsVersion","sql":"\n\t\t\tUPDATE wst.app_version \n\t\t\tSET is_latest = TRUE \n\t\t\tWHERE\n\t\t\tdate_released = ( SELECT MAX(date_released) FROM wst.app_version WHERE app_id = $1 AND is_latest = FALSE) \n\t\t\tAND app_id = $1;\n\t\t","time":21821204,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.704Z","msg":"Prepare","pid":3006498,"name":"SqlQueryAppUserByMac","sql":"SELECT user_name,password,mac,ip,country,city,distributor_id,model_id,last_login,is_active,is_service,is_expired FROM wst.app_user WHERE mac = $1 AND deleted = false;","time":14986993,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:59:54.724Z","msg":"Prepare","name":"SqlInsertFailureRecord","sql":"\n\t\t\tINSERT INTO wst.failure_log (\n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id, \n\t\t\t\tmac, \n\t\t\t\tdeleted\n\t\t\t) VALUES (\n\t\t\t\t$1,$2, $3,$4\n\t\t\t) ON CONFLICT (mac) DO NOTHING;\n\t\t","time":20010691,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.741Z","msg":"Prepare","name":"SqlQueryAppsVersionList","sql":"\n\t\t\tselect f.id,\n\t\t\t       f.app_id,\n\t\t\t       f.version_name,\n\t\t\t       f.date_released,\n\t\t\t       f.changelog,\n\t\t\t       f.is_latest,\n\t\t\t       f.is_public,\n\t\t\t       f.is_paid,\n\t\t\t       f.filesize,\n\t\t\t       f.md5,\n\t\t\t       f.url,\n\t\t\t       f.force_uninstall,\n\t\t\t       f.filesize \n\t\t\tfrom wst.app_version f \n\t\t\twhere f.deleted = false \n\t\t\tand f.app_id = $1::int  \n\t\t\tlimit $2 offset $3;\n\t\t","time":17724763,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.756Z","msg":"Prepare","name":"SqlCountCategoriesList","sql":"select count(id) as total from wst.categories f where \n\t\t\t\t\t\t\t  \tCASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\t\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\t\t\t\t\tAND f.deleted = FALSE;","time":14137614,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.778Z","msg":"Prepare","name":"SqlUpdatePricePlan","sql":"\n\t\t\tupdate wst.price_plans \n\t\t\tset plan_name = $1, \n\t\t\t    plan_description = $2, \n\t\t\t    billing_cycle = $3, \n\t\t\t    trial_period = $4, \n\t\t\t    price = $5, \n\t\t\t    distributor_id = $6, \n\t\t\t    model_id = $7, \n\t\t\t    deleted = $8 \n\t\t\twhere id = $9;\n\t\t","time":21958515,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.814Z","msg":"Prepare","pid":3006498,"name":"SqlQueryPricePlanList","sql":"\n\t\t\tselect \n\t\t\t\tf.id, \n\t\t\t\tf.plan_name, \n\t\t\t\tf.plan_description, \n\t\t\t\tf.billing_cycle, \n\t\t\t\tf.trial_period, \n\t\t\t\tf.price, \n\t\t\t\tf.distributor_id, \n\t\t\t\tf.model_id, \n\t\t\t\td.title as distributorName, \n\t\t\t\tm.name as modelName \n\t\t\tfrom \n\t\t\t\twst.price_plans f \n\t\t\t\tjoin wst.distributor d on f.distributor_id = d.id \n\t\t\t\tjoin wst.model m on f.model_id = m.id \n\t\t\twhere \n\t\t\t\tf.deleted = false \n\t\t\tlimit $1 offset $2;\n\t\t","time":14311707,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:59:54.831Z","msg":"Prepare","name":"SqlCheckAppUniqueByAdd","sql":"\n\t\t\tselect count(id)\n\t\t\tfrom wst.apps\n\t\t\twhere class = $1\n\t\t\t  AND distributor_id = $2\n\t\t\t  AND model_id = $3\n\t\t\t  AND deleted = false\n\t\t\t;\n\t\t","time":16180743,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.845Z","msg":"Prepare","name":"SqlCheckAppUniqueByUpdate","sql":"\n\t\t\tselect id\n\t\t\tfrom wst.apps\n\t\t\twhere class = $1\n\t\t\t  AND distributor_id = $2\n\t\t\t  AND model_id = $3\n\t\t\t  AND deleted = false\n\t\t\t;\n\t\t","time":13889341,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.867Z","msg":"Prepare","time":22502678,"alreadyPrepared":false,"pid":3006498,"name":"SqlDeleteApps","sql":"\n\t\t\t\t\t\tDelete \n\t\t\t\t FROM wst.apps\n  \t\t\t\t WHERE id = $1\n\t\t"}
{"level":"info","time":"2024-10-30T05:59:54.888Z","msg":"Prepare","alreadyPrepared":false,"pid":3006498,"name":"SqlDeleteAppsVersion","sql":"\n\t\t\t\t\t\tDelete \n\t\t\t\t FROM wst.app_version\n  \t\t\t\t WHERE app_id = $1\n\t\t","time":20384538}
{"level":"info","time":"2024-10-30T05:59:54.905Z","msg":"Prepare","name":"SqlUpdateSelf","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND V.\"class\" = $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t","time":17075235,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.921Z","msg":"Prepare","pid":3006498,"name":"SqlInsertCategories","sql":"insert into wst.categories (category_name,distributor_id,model_id,sort) values ($1,$2,$3,$4);","time":15031432,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:59:54.946Z","msg":"Prepare","name":"SqlInsertPricePlan","sql":"\n\t\t\tinsert into wst.price_plans (\n\t\t\t\tplan_name, \n\t\t\t\tplan_description, \n\t\t\t\tbilling_cycle, \n\t\t\t\ttrial_period, \n\t\t\t\tprice, \n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7\n\t\t\t);\n\t\t","time":15312517,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:54.972Z","msg":"Prepare","pid":3006498,"name":"SqlQueryAllPricePlan","sql":"\n\t\t\tSELECT \n\t\t\t\tC.ID AS id, \n\t\t\t\tCONCAT(C.plan_name, ' - ', d.title, ' - ', M.NAME) AS label \n\t\t\tFROM \n\t\t\t\twst.price_plans C \n\t\t\t\tLEFT JOIN wst.distributor d ON C.distributor_id = d.ID \n\t\t\t\tLEFT JOIN wst.model M ON C.model_id = M.ID;\n\t\t","time":25459368,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:59:54.992Z","msg":"Prepare","pid":3006498,"name":"SqlGetAppsByCategories","sql":"\n\t\t\tSELECT\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip,\n\t\t\t\tf.catpromo,\n\t\t\t\tf.category_id AS categories_id\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids)\n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND $1 = ANY(f.category_ids)\n\t\t\t  \tAND c.id =  $1\n\t\t\t\tAND f.distributor_id = $2::bigint\n\t\t\t\tAND f.model_id = $3::bigint\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND f.is_show_on_market = 1\n\t\t\tORDER BY\n\t\t\t\t  CAST(app_sort AS INTEGER) ASC;\n\t\t","time":20596226,"alreadyPrepared":false}
{"level":"info","time":"2024-10-30T05:59:55.005Z","msg":"Prepare","name":"SqlCountAppUserList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.app_user f\n\t\t\twhere CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.mac ILIKE '%' ||$3 || '%' END\n\t\t\tAND f.deleted = FALSE\n\t\t","time":13095731,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.020Z","msg":"Prepare","name":"SqlQueryAppUserList","sql":"\n\t\t\tSELECT\n\t\t\t\tf.user_name,\n\t\t\t\tf.PASSWORD,\n\t\t\t\tf.mac,\n\t\t\t\tf.ip,\n\t\t\t\tf.country,\n\t\t\t\tf.city,\n\t\t\t\tf.last_login,\n\t\t\t\tf.OPERATOR,\n\t\t\t\tf.distributor_id,\n\t\t\t\tf.model_id,\n\t\t\t\td.title :: TEXT AS distributorName,\n\t\t\t\tM.NAME :: TEXT AS modelName,\n\t\t\t\tf.is_active,\n\t\t\t    f.is_service,\n\t\t\t    f.is_expired\n\t\t\tFROM\n\t\t\t\twst.app_user f\n\t\t\t\tJOIN wst.distributor d ON f.distributor_id = d.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID \n\t\t\twhere \n\t\t\t    CASE WHEN $1 = '' THEN TRUE ELSE f.distributor_id =$1::BIGINT END\n\t\t\t\tAND CASE WHEN $2 = '' THEN TRUE ELSE f.model_id =$2::BIGINT END\n\t\t\t\tAND CASE WHEN $3 = '' THEN TRUE ELSE f.mac ILIKE '%' ||$3 || '%' END\n\t\t\t\tAND f.deleted = FALSE\n\t\t\tLIMIT $4 OFFSET $5;\n\t\t","time":14826047,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.047Z","msg":"Prepare","name":"SqlInsertAppUser","sql":"\n\t\t\tINSERT INTO wst.app_user (\n\t\t\t\tuser_name, \n\t\t\t\tPASSWORD, \n\t\t\t\tmac, \n\t\t\t\tip, \n\t\t\t\tcountry, \n\t\t\t\tcity, \n\t\t\t\tdistributor_id, \n\t\t\t\tmodel_id, \n\t\t\t\tlast_login, \n\t\t\t\toperator, \n\t\t\t\tdeleted,\n\t\t\t\tis_active,\n\t\t\t  \tis_expired,\n\t\t\t    is_service                      \n\t\t\t) VALUES (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12,$13,$14\n\t\t\t) ON CONFLICT (mac) DO NOTHING\n\t\t\tRETURNING user_name, PASSWORD, mac, ip, country, city, distributor_id, model_id, last_login, operator;\n\t\t","time":26451385,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.066Z","msg":"Prepare","name":"SqlDeleteAppUser","sql":"\n\t\t\tDELETE FROM wst.app_user WHERE mac = $1;\n\t\t","time":18509483,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.084Z","msg":"Prepare","name":"SqlCountPricePlanList","sql":"\n\t\t\tselect count(id) as total \n\t\t\tfrom wst.price_plans \n\t\t\twhere deleted = false;\n\t\t","time":18038574,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.109Z","msg":"Prepare","time":24859042,"alreadyPrepared":false,"pid":3006498,"name":"SqlQueryAllCategories","sql":"\n\t\t\tSELECT \n\t\t\t\tC.ID AS category_ids,\n\t\t\t\tCONCAT(C.category_name, ' - ', d.title, ' - ', M.NAME) AS label \n\t\t\tFROM \n\t\t\t\twst.categories C \n\t\t\t\tLEFT JOIN wst.distributor d ON C.distributor_id = d.ID \n\t\t\t\tLEFT JOIN wst.model M ON C.model_id = M.ID\n\t\t\t\tWhere c.deleted = false\n\t\t\t;\n\t\t"}
{"level":"info","time":"2024-10-30T05:59:55.121Z","msg":"Prepare","time":12103491,"alreadyPrepared":false,"pid":3006498,"name":"SqlGetAppDownloadUrl","sql":"\n\t\t\tSELECT url \n\t\t\tFROM wst.app_version \n\t\t\tWHERE app_id = $1 AND is_latest = TRUE AND deleted = false;\n\t\t"}
{"level":"info","time":"2024-10-30T05:59:55.141Z","msg":"Prepare","time":19497750,"alreadyPrepared":false,"pid":3006498,"name":"SqlInsertApps","sql":"\n\t\t\tinsert into wst.apps (\n\t\t\t\tapp_name,\n\t\t\t\tapp_description,\n\t\t\t\tapp_icon,\n\t\t\t\tapp_carousel,\n\t\t\t\tapp_sort,\n\t\t\t\tapp_banner,\n\t\t\t\tsystem_requirement,\n\t\t\t\trating,\n\t\t\t\tcopyright_notice,\n\t\t\t\tdistributor_id,\n\t\t\t\tmodel_id,\n\t\t\t\tdeleted,\n\t\t\t\tprice_plan_ids,\n\t\t\t\tclass,\n\t\t\t\tcategory_ids,\n\t\t\t\tis_show_on_market,\n\t\t\t\tis_show_tool_tip,\n\t\t\t    catpromo,\n\t\t\t    category_id               \n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13,$14, $15,$16, $17, $18,$19\n\t\t\t);\n\t\t"}
{"level":"info","time":"2024-10-30T05:59:55.153Z","msg":"Prepare","name":"SqlInsertAppByCopy","sql":"\n\t\t\tinsert into wst.apps (\n\t\t\t\tapp_name,\n\t\t\t\tapp_description,\n\t\t\t\tapp_icon,\n\t\t\t\tapp_carousel,\n\t\t\t\tapp_sort,\n\t\t\t\tapp_banner,\n\t\t\t\tsystem_requirement,\n\t\t\t\trating,\n\t\t\t\tcopyright_notice,\n\t\t\t\tdistributor_id,\n\t\t\t\tmodel_id,\n\t\t\t\tdeleted,\n\t\t\t\tprice_plan_ids,\n\t\t\t\tclass,\n\t\t\t\tcategory_ids,\n\t\t\t\tis_show_on_market,\n\t\t\t\tis_show_tool_tip,\n\t\t\t    catpromo\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13,$14, $15,$16, $17, $18\n\t\t\t) RETURNING  id;\n\t\t","time":12167090,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.189Z","msg":"Prepare","name":"SqlQueryAppVersionIsLatestByAppId","sql":"\n\t\t\t\t\t\tSelect \n\t\t\t\t\t\t version_name,\n\t\t\t\t\t\t changelog,\n\t\t\t\t\t\t is_latest,\n\t\t\t\t\t\t is_public,\n\t\t\t\t\t\t is_paid,\n\t\t\t\t\t\t filesize,\n\t\t\t\t\t\t md5,\n\t\t\t\t\t\t url,\n\t\t\t\t\t\t force_uninstall,\n\t\t\t\t\t\t class\n\t\t\t\t FROM wst.app_version\n  \t\t\t\t WHERE app_id = $1\n\t\t\t\t AND deleted = false\n\t\t\t     AND is_latest = true;\n\t\t","time":22639363,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.200Z","msg":"Prepare","name":"SqlUpdateAppUser","sql":"\n\t\t\tupdate wst.app_user \n\t\t\tset user_name = $1, \n\t\t\t    password = $2, \n\t\t\t    ip = $3, \n\t\t\t    country = $4, \n\t\t\t    city = $5, \n\t\t\t    distributor_id = $6, \n\t\t\t    model_id = $7, \n\t\t\t    deleted = $8,\n\t\t\t    is_active = $9,\n\t\t\t    is_service = $10,\n\t\t\t    is_expired = $11\n\t\t\tWHERE mac = $12;\n\t\t","time":11416150,"alreadyPrepared":false,"pid":3006498}
{"level":"info","time":"2024-10-30T05:59:55.220Z","msg":"Prepare","time":19900927,"alreadyPrepared":false,"pid":3006498,"name":"SqlInsertAppsVersion","sql":"\n\t\t\tinsert into wst.app_version (\n\t\t\t\tapp_id,\n\t\t\t\tversion_name,\n\t\t\t\tdate_released,\n\t\t\t\tchangelog,\n\t\t\t\tis_latest,\n\t\t\t\tis_public,\n\t\t\t\tis_paid,\n\t\t\t\tfilesize,\n\t\t\t\tmd5,\n\t\t\t\turl,\n\t\t\t\tforce_uninstall,\n\t\t\t\tdeleted,\n\t\t\t\tclass\n\t\t\t) values (\n\t\t\t\t$1,$2, $3,$4, $5,$6, $7,$8, $9,$10, $11,$12, $13\n\t\t\t);\n\t\t"}
{"level":"info","time":"2024-10-30T05:59:55.240Z","msg":"Prepare","time":19815528,"alreadyPrepared":false,"pid":3006498,"name":"SqlUpdateCategories","sql":"update wst.categories set category_name = $1,deleted = $2,distributor_id = $3,model_id = $4,sort = $5 where id = $6;"}
{"level":"info","time":"2024-10-30T05:59:55.257Z","msg":"Prepare","name":"SqlQueryAppsNewestVersion","sql":"\n\t\t\tSELECT DISTINCT ON (f.ID)\n\t\t\t\tf.ID AS apk_id,\n\t\t\t\tf.app_name,\n\t\t\t\tf.app_description,\n\t\t\t\tf.app_icon,\n\t\t\t\tf.app_carousel,\n\t\t\t\tf.app_sort,\n\t\t\t\tf.app_banner,\n\t\t\t\tf.system_requirement,\n\t\t\t\tf.rating,\n\t\t\t\tf.copyright_notice,\n\t\t\t\tC.category_name AS categories_name,\n\t\t\t\tP.plan_name AS price_plans_name,\n\t\t\t\tP.price AS price,\n\t\t\t\tf.deleted,\n\t\t\t\tf.CLASS,\n\t\t\t\tV.version_name AS VERSION,\n\t\t\t\tV.md5,\n\t\t\t\tV.url,\n\t\t\t\tV.filesize,\n\t\t\t\tf.is_show_on_market,\n\t\t\t\tf.is_show_tool_tip\n\t\t\tFROM\n\t\t\t\twst.apps f\n\t\t\t\tJOIN wst.categories C ON c.id = ANY(f.category_ids)\n\t\t\t\tJOIN wst.price_plans P ON p.id = ANY(f.price_plan_ids) \n\t\t\t\tJOIN wst.distributor D ON f.distributor_id = D.ID\n\t\t\t\tJOIN wst.model M ON f.model_id = M.ID\n\t\t\t\tJOIN wst.app_version V ON f.ID = V.app_id\n\t\t\tWHERE\n\t\t\t\tf.deleted = FALSE\n\t\t\t\tAND V.is_latest = TRUE\n\t\t\t\tAND V.\"class\" = $1\n\t\t\t\tAND f.distributor_id = $2\n\t\t\t\tAND f.model_id = $3\n\t\t","time":16197885,"alreadyPrepared":false,"pid":3006498}
